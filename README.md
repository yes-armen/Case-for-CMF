# Есаян Армен, 2 курс, МатФак ВШЭ
# Кейс по алгоритмическому трейдингу 
 
 В данной работе в качестве финансового инструмента рассматривается пут-опцион на фьючерс на индекс S&P500.
 Решение кейса представляет из себя проверку научной гипотезы О.Бондаренко, описанной в статье "Why are Put Options so Expensive?" (см. по ссылке https://papers.ssrn.com/sol3/papers.cfm?abstract_id=375784). Хотим проверить, что премии за пут-опционы данного базового актива переоценены, и реализовать стратегию, в которой данный базовый актив мы будем шортить.
 
 Решение кейса состоит из трех частей.
 
__Часть 1 (мотивация).__ Рассматривается подразумеваемая волатильность (implied volatility) пут-опционов фьючерса на S&P500 с датой экспирации в сентябре 2021 года, торгующиеся 24 августа 2021 года (файл data.csv, данные взяты с сайта https://www.cmegroup.com/markets/equities/sp/sandp-500.settlements.options.html#optionProductId=135&optionExpiration=135-U1&tradeDate=08%2F24%2F2021).

Взяв опционы со стоимостью страйка +-10% от уровня страйка ATM опциона (для отсечения самых неликвидных), строится график зависимости подразумеваемой волатильности от денежности опциона.

Подразумеваемую волатильность можно найти приближенно, решив уравнение Блэка-Шоулза "наоборот", зная все параметры, кроме, как раз-таки, волатильности. Для этого вычисляется "грек" вега, и при помощи метода Эйлера находится параметр сигма с заранее установленной точностью и максимальным количеством шагов.

Вывод: премии пут-опционов на данный базовый актив переоценены.
 
__Часть 2 (торговая стратегия - код).__ Стратегия, рассматриваемая в данной работе, представляет из себя продажу в шорт пут-опционов при определённом поведении рынка и прекращение трейдинга на некоторое время при достаточно высоких значениях X индекса волатильности S&P VIX. Прекращать шортить фьючерс на S&P при панике на рынке мотивирована высокими рисками и вероятностью того, что рынок поведет себя иррационально, что не учитывается в модели, на которой основана наша стратегия. В каждый момент времени t мы либо покупаем, либо продаем данный базовый актив, то есть мы не докупаемся и не увеличиваем позицию.

  Чистая прибыль, полученная в момент времени t, считается по следующей формуле: 
  
  $$P\&L_{t} = \begin{cases}
S_{t + 1} - K_{t} + Put_{t}; \ \ если \ \  VIX_{t} < X \ и \  S_{t + 1} \leq K_{t} \\
Put_{t}; \ \ если \ \ VIX_{t} < X \ и \ S_{t + 1} > K_{t} \\
0; \ \ если \ \ VIX_{t} \geq X 
\end{cases}$$

где:
* <img src="https://render.githubusercontent.com/render/math?math={\color{white}Put_{t}">- стоимость премии пут-опциона
* $X$ - пороговое значение индекса VIX
* $K_{t} = S\&P_{t}$ - страйк в момент времени t
* $S_{t+1} = S\&P_{t + 1}$ - стоимость базового актива (уровень индекса S&P500) в момент времени t+1

Разность между t+1 и t - месяц без выходных дней (примерно 25 дней)

Пороговое значение VIX выбирается таким образом, чтобы максимизировать коэффициент Шарпа.

__Часть 3 (бэктестирование)__

Для бэктестирования рассматрены коэффициент Шарпа и отношение накопленной доходности к максимальной просадке.
Построены графики зависимости исторической чистой прибыли для данных в обучающей и тестовой выборке.
